
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>The Network Builder &#8212; Brain Modeling Toolkit 1.0.6 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/aibs_sphinx.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Simulation Engines" href="simulators.html" />
    <link rel="prev" title="Installing the BMTK" href="installation.html" /> 
  </head><body>
<script type="text/javascript" src="_static/external_assets/javascript/portal.js"></script>
<style>

	/* the icon font-family definition and helper classes */
	@font-face {
	  font-family: 'portal_icon_font';
	  src: url('_static/external_assets/stylesheets/portal_icon_font.eot?39505677');
	  src: url('_static/external_assets/stylesheets/portal_icon_font.eot?39505677#iefix') format('embedded-opentype'),
	       url('_static/external_assets/stylesheets/portal_icon_font.woff?39505677') format('woff'),
	       url('_static/external_assets/stylesheets/portal_icon_font.ttf?39505677') format('truetype'),
	       url('_static/external_assets/stylesheets/portal_icon_font.svg?39505677#portal_icon_font') format('svg');
	  font-weight: normal;
	  font-style: normal;
	}
	 
	 [class^="icon-"]:before, [class*=" icon-"]:before {
	  font-family: "portal_icon_font";
	  font-style: normal;
	  font-weight: normal;
	  speak: none;
	 
	  display: inline-block;
	  text-decoration: inherit;
	  width: 1em;
	  margin-right: .2em;
	  text-align: center;
	  /* opacity: .8; */
	 
	  /* For safety - reset parent styles, that can break glyph codes*/
	  font-variant: normal;
	  text-transform: none;
	     
	  /* fix buttons height, for twitter bootstrap */
	  line-height: 1em;
	 
	  /* Animation center compensation - margins should be symmetric */
	  /* remove if not needed */
	  margin-left: .2em;
	
	}
	 
	.icon-spin5:before { content: '\e806'; } /* '' */
	.icon-left-open-1:before { content: '\e81e'; } /* '' */
	.icon-plus-1:before { content: '\e801'; } /* '' */
	.icon-facebook:before { content: '\e816'; } /* '' */
	.icon-gplus:before { content: '\e818'; } /* '' */
	.icon-linkedin-3:before { content: '\e815'; } /* '' */
	.icon-twitter:before { content: '\e817'; } /* '' */
	.icon-youtube-play:before { content: '\e805'; } /* '' */
	.icon-plus-2:before { content: '\e809'; } /* '' */
	.icon-record-1:before { content: '\e81c'; } /* '' */
	.icon-cancel:before { content: '\e80b'; } /* '' */
	.icon-search:before { content: '\e804'; } /* '' */
	.icon-cancel-2:before { content: '\e80c'; } /* '' */
	.icon-plus-4:before { content: '\e80d'; } /* '' */
	.icon-cancel-3:before { content: '\e80e'; } /* '' */
	.icon-plus:before { content: '\e808'; } /* '' */
	.icon-down-open:before { content: '\e800'; } /* '' */
	.icon-right-open:before { content: '\e802'; } /* '' */
	.icon-up-open:before { content: '\e803'; } /* '' */
	.icon-stop:before { content: '\e813'; } /* '' */
	.icon-cancel-1:before { content: '\e820'; } /* '' */
	.icon-plus-3:before { content: '\e80a'; } /* '' */
	/* end icon font helpers */

	/* icon font spin animation */
	.animate-spin {
	  -moz-animation: spin 2s infinite linear;
	  -o-animation: spin 2s infinite linear;
	  -webkit-animation: spin 2s infinite linear;
	  animation: spin 2s infinite linear;
	  display: inline-block;
	}
	@-moz-keyframes spin {
	  0% {
	    -moz-transform: rotate(0deg);
	    -o-transform: rotate(0deg);
	    -webkit-transform: rotate(0deg);
	    transform: rotate(0deg);
	  }

	  100% {
	    -moz-transform: rotate(359deg);
	    -o-transform: rotate(359deg);
	    -webkit-transform: rotate(359deg);
	    transform: rotate(359deg);
	  }
	}
	@-webkit-keyframes spin {
	  0% {
	    -moz-transform: rotate(0deg);
	    -o-transform: rotate(0deg);
	    -webkit-transform: rotate(0deg);
	    transform: rotate(0deg);
	  }

	  100% {
	    -moz-transform: rotate(359deg);
	    -o-transform: rotate(359deg);
	    -webkit-transform: rotate(359deg);
	    transform: rotate(359deg);
	  }
	}
	@-o-keyframes spin {
	  0% {
	    -moz-transform: rotate(0deg);
	    -o-transform: rotate(0deg);
	    -webkit-transform: rotate(0deg);
	    transform: rotate(0deg);
	  }

	  100% {
	    -moz-transform: rotate(359deg);
	    -o-transform: rotate(359deg);
	    -webkit-transform: rotate(359deg);
	    transform: rotate(359deg);
	  }
	}
	@-ms-keyframes spin {
	  0% {
	    -moz-transform: rotate(0deg);
	    -o-transform: rotate(0deg);
	    -webkit-transform: rotate(0deg);
	    transform: rotate(0deg);
	  }

	  100% {
	    -moz-transform: rotate(359deg);
	    -o-transform: rotate(359deg);
	    -webkit-transform: rotate(359deg);
	    transform: rotate(359deg);
	  }
	}
	@keyframes spin {
	  0% {
	    -moz-transform: rotate(0deg);
	    -o-transform: rotate(0deg);
	    -webkit-transform: rotate(0deg);
	    transform: rotate(0deg);
	  }

	  100% {
	    -moz-transform: rotate(359deg);
	    -o-transform: rotate(359deg);
	    -webkit-transform: rotate(359deg);
	    transform: rotate(359deg);
	  }
	}
	/*  end spin animation */	

	@font-face {
	    font-family: 'bebas_neueregular';
	    src: url('_static/external_assets/stylesheets/bebasneue-webfont.eot');
	    src: url('_static/external_assets/stylesheets/bebasneue-webfont.eot?#iefix') format('embedded-opentype'),
	         url('_static/external_assets/stylesheets/bebasneue-webfont.woff') format('woff'),
	         url('_static/external_assets/stylesheets/bebasneue-webfont.ttf') format('truetype'),
	         url('_static/external_assets/stylesheets/bebasneue-webfont.svg#bebas_neueregular') format('svg');
	    font-weight: normal;
	    font-style: normal;
	}

	/* top chrome styles */
	#top_chrome {

		width:100%;
		height:28px;
		background-color:#163E65;
	}

	.chrome_link_block {

		color:#fff !important;	
		display:inline-block;
		height:100%;
		max-height:28px;
	}

	.chrome_link_block:hover {

		background-color:#eee;
		color:#0779BE !important;	
		cursor:pointer;
	}

	#top_chrome a {

		color:inherit !important;	
		text-decoration:none;
	}

	#top_chrome a:hover {

		color:inherit !important;	
	}

	#top_chrome_buttons {

		float:right;
		margin-right:50px;
	}

	.chrome_button {

		font-family:arial,sans-serif;
		font-weight:bold;
		display:inline-block;
		font-size:9px;
		text-align:left;
		text-decoration:none;
		margin:9px 20px 10px 20px;
	}

	.chrome_active {

		background-color:#1b7abd;
		color:#fff;
	}


	/* header element styles*/
	#header_content {

		font-family: bebas_neueregular, arial, sans-serif;
		font-size:22px;
		color:#0779be;		
		letter-spacing:0.03em;

		position:relative;
		width:calc(100% - 112px);
		min-width:800px;
		height:76px;
		border-bottom:2px solid #A5A8AB;
		margin-left:50px;
		margin-right:50px;
        z-index:9999; /* IT-9508 */
	}

	#portal_logo {

		position:absolute;
		top:20px;
		left:0px;
		width:236px;
	}

	#portal_tabs {

		position: absolute;
		bottom: 12px;
		left: 0px;
		margin-bottom: -12px;
		display: block;
	}

	.horizontal_list
	{
		margin: 0;
		padding: 0;
		list-style-type: none;
		display: inline; 		
	}

	.horizontal_list li { 

		display: inline; 	
	}	

	#portal_tab_menu_container {

		display:none;
	}

	#portal_search_input_group {

		position:absolute;
		margin: 0;
		padding: 0;
		bottom:12px;
		right:0px;
		border:1px solid #DAD9D3;
		color:#DAD9D3;
	}

	#portal_search_input_group input {

		margin: 0;
		padding: 0;
		border:none;
		width:110px;
		color:#DAD9D3;
		font-family:Helvetica,sans-serif;
		font-size:12px;
		height:28px;
		margin-left:10px;

		outline:none;
	}

	input::-ms-clear {
		display: none;
	}

	#portal_search_input_group i {

		font-size:0.8em;
		cursor:pointer;
	}

	#pSiteSearchTextInput:focus {

		color:#000;
	}

	.icon_menu_down {

		font-size: 12px;
		margin-left: 4px;
		vertical-align: text-top;
		padding-top: 4px;
		display: inline-block;
	}

	.portal_tab_item {

		background-color: #fff;
		padding: 12px;
		padding-left:20px;
		padding-right:20px;
		display: inline-block !important;		
	}

	.portal_tab_item a:hover {

		color:#fbe300;	
	}

	.portal_tab_item:hover {

		background-color: #0779be;	
		color:#fbe300 !important;	
	}	


	.portal_menu_active {

		background-color: #EEEEEE;
	}	

	.portal_menu_item_active {

		color:#fbe300 !important;	
	}

	.portal_tab_active {

		color:#a5a8ab !important;
	}

	#header_content a {		

		color:inherit !important;
	}

	#header_content a:hover {

		background-color: #0779be;	
		color:#fbe300 !important;	
	}

	#header_content ul {

		list-style: none;
		position: relative;
		top: 58px;
		display: inline-table;
	}

	#header_content ul ul {
		
		display:none;
		opacity:0;
	}

	/* the fly out menus */
	#header_content ul li:hover > ul,
	#header_content ul li.hover > ul {

		position: absolute;
		top: 48px;
		z-index:999;

		display: block;
		width: 152px;
		padding:0px;
		padding-top:20px;
		padding-bottom:10px;
		font-size: 12px;
		font-family: Arial,Sans-Serif;
		font-weight: bold;
		text-transform: uppercase;

		background-color: rgba(8,122,191,0.98);
		color: #fff !important;
		opacity: 1;

		-webkit-animation: fade 0.25s;
		animation: fade 0.25s;
	}

	@-webkit-keyframes fade {
	    from {opacity: 0}
	    to {opacity: 1}
	}
	@keyframes fade {
	    from {opacity: 0}
	    to {opacity: 1}
	}	

	#header_content ul li:hover > ul li {

		padding: 10px;
		padding-top: 0px;
		padding-left: 20px;
		display: block;
		opacity:1;
	}

	#header_content ul li:hover > ul a {

		display: block;
		opacity:1;
		white-space:nowrap;
	}

	#portal_menu_start_list {

		left: 81px;

		/* IE sauce */
		left:85px\9;

		/* Safari sauce */
		(;left:79px;);
	}

	#portal_menu_atlases_list {

		left: 290px;
		width: 210px !important;
        height: 236px;

		padding-bottom:5px !important;

		/* IE sauce */
		left: 303px\9;
        height: 225px\9;

		/* Safari sauce */
		(;left:279px;);
	}

	#portal_menu_tools_list {

		left: 500px;
		width: 172px !important;
		height: 236px;

		padding-bottom:5px !important;

		/* IE sauce */
		left: 513px\9;
		height:225px\9;

		/* Safari sauce */
		(;left:489px;);
		(;height:227px;);
	}

	/* mozilla sauce */
	@-moz-document url-prefix() {

		#header_content {

			height:107px;
		}

		#portal_menu_start_list {

			left:85px;
		}

		#portal_menu_atlases_list {

			left: 302px;		
		}

		#portal_menu_tools_list {

			left: 512px;
			height:236px;
		}
	}


	/* make it look OK on iPad also */
	@media all and (device-width: 768px) and (device-height: 1024px) and (orientation:portrait) {

		#portal_menu_start_list {

			left:81px;
		}

		#portal_menu_atlases_list {

			left: 291px;		
		}

		#portal_menu_tools_list {

			left: 501px;
			height:236px;
		}  
	}
	@media all and (device-width: 768px) and (device-height: 1024px) and (orientation:landscape) {

		#portal_menu_start_list {

			left:81px;
		}

		#portal_menu_atlases_list {

			left: 291px;		
		}

		#portal_menu_tools_list {

			left: 501px;
			height:236px;
		}	  
	}

	.portal_menu_list_heading {

		color:#9ccae5;
		border-bottom:1px solid #9ccae5;
		padding-bottom:5px !important;
	}

	.portal_menu_list_heading + li {

		padding-top:10px !important;
	}

	.portal_menu_list_heading li {

		padding-bottom:0px;
	}	

	#portal_menu_atlases_list li:last-of-type {

		padding-bottom:15px !important;
	}

	.icon-spin5 {

		color:#000;
	}
</style>
<div id="pHeader">
<div id="top_chrome">
	<div id="top_chrome_buttons">
		<div class="chrome_link_block"><a href="http://www.alleninstitute.org" target="_blank" class="chrome_button">ALLEN INSTITUTE</a></div>
	</div>
</div>

<div id="header_content">

	<a href="http://AllenInstitute.github.io">
		<img id="portal_logo" style="border:0;" src="_static/external_assets/images/AIBS_Logo.png"/>
	</a>
</div>
</div>

<script>

jQuery('#portal_tab_menu').bind('touchstart', function() {

	if(window.console)
		console.log("touchstart");
});
</script>
<link rel="stylesheet" type="text/css" href="_static/external_assets/stylesheets/common_layout.css" />


  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="the-network-builder">
<h1>The Network Builder<a class="headerlink" href="#the-network-builder" title="Permalink to this headline">¶</a></h1>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/bmtk_architecture_builder_highlight.jpg"><img alt="_images/bmtk_architecture_builder_highlight.jpg" src="_images/bmtk_architecture_builder_highlight.jpg" style="width: 433.6px; height: 167.20000000000002px;" /></a>
</figure>
<p>The class for building a brain network is <code class="xref py py-class docutils literal notranslate"><span class="pre">bmtk.builder.NetworkBuilder</span></code>. This
should be used whether one is building a biophysically detailed network for BioNet, a point-neuron network for PointNet,
A filter-based lnp network for FitlerNet, or a population-level network for PopNet. In general, it can be used to build
any type of heterogeneous parameter multi-graph.</p>
<p>The process of building the network can break down into four parts:</p>
<ol class="arabic simple">
<li><p>Initialize the Network. Here all one needs is a unique name to identify the population of nodes - usually, the region
being model</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bmtk.builder</span> <span class="kn">import</span> <span class="n">NetworkBuilder</span>

<span class="n">net</span> <span class="o">=</span> <span class="n">NetworkBuilder</span><span class="p">(</span><span class="s2">&quot;network_name&quot;</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Create the nodes (ie. cells) using the <code class="xref py py-meth docutils literal notranslate"><span class="pre">add_nodes()</span></code> method. For
different types/models of cells we can use separate calls to add_nodes (often with different model parameters).</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">add_nodes</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;Biophysical&#39;</span><span class="p">,</span> <span class="n">ei</span><span class="o">=</span><span class="s1">&#39;exc&#39;</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">add_nodes</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;IntFire&#39;</span><span class="p">,</span> <span class="n">ei</span><span class="o">=</span><span class="s1">&#39;inh&#39;</span><span class="p">,</span> <span class="n">vrest</span><span class="o">=-</span><span class="mf">50.0</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/builder_add_nodes.jpg"><img alt="_images/builder_add_nodes.jpg" src="_images/builder_add_nodes.jpg" style="width: 370.40000000000003px; height: 199.20000000000002px;" /></a>
</figure>
<ol class="arabic simple" start="3">
<li><p>Create Connection rules between different subsets of nodes using <code class="xref py py-meth docutils literal notranslate"><span class="pre">add_edges()</span></code>
method.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ei&#39;</span><span class="p">:</span> <span class="s1">&#39;exc&#39;</span><span class="p">},</span> <span class="n">target</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ei&#39;</span><span class="p">:</span> <span class="s1">&#39;inh&#39;</span><span class="p">},</span> <span class="n">connection_rule</span><span class="o">=</span><span class="n">my_conn_func</span><span class="p">,</span> <span class="n">synaptic_model</span><span class="o">=</span><span class="s1">&#39;e2i&#39;</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ei&#39;</span><span class="p">:</span> <span class="n">inh</span><span class="p">},</span> <span class="n">target</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ei&#39;</span><span class="p">:</span> <span class="s1">&#39;exc&#39;</span><span class="p">},</span> <span class="n">connection_rule</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">synaptic_model</span><span class="o">=</span><span class="s1">&#39;i2e&#39;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/builder_add_edges.jpg"><img alt="_images/builder_add_edges.jpg" src="_images/builder_add_edges.jpg" style="width: 366.75px; height: 254.25px;" /></a>
</figure>
<ol class="arabic simple" start="4">
<li><p>Finally use <code class="xref py py-meth docutils literal notranslate"><span class="pre">build()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code>
methods to build and save the model to the file</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="n">net</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;/path/to/network/output/&#39;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/builder_complete_network.jpg"><img alt="_images/builder_complete_network.jpg" src="_images/builder_complete_network.jpg" style="width: 229.0px; height: 188.0px;" /></a>
</figure>
<section id="building-nodes">
<h2>Building Nodes<a class="headerlink" href="#building-nodes" title="Permalink to this headline">¶</a></h2>
<p>In BMTK and SONATA a node usually is synonymous with a cell (although a node can be used to represent a population of
cells with <a class="reference external" href="./popnet.html">PopNet</a>). To add a group of nodes to a network is to use the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">NetworkBuilder.add_nodes()</span></code>.</p>
<p>The only thing that is required is an integer value N for the number of individual nodes. The modeler can also pass in
any parameter they want to describe their model - although SONATA/BMTK does contain a number of reserved node parameters
that will be useful in generating an instantiable model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;biophysical&#39;</span><span class="p">,</span> <span class="n">dynamics_params</span><span class="o">=</span><span class="s1">&#39;rorb_params.json&#39;</span><span class="p">,</span> <span class="n">morphology</span><span class="o">=</span><span class="s1">&#39;rorb.swc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In the above example, all 100 nodes share the same values for <code class="docutils literal notranslate"><span class="pre">model_type</span></code>, <code class="docutils literal notranslate"><span class="pre">dynamics_params</span></code>, and <code class="docutils literal notranslate"><span class="pre">morphology</span></code>.
To have unique parameter values for each N node you only need to pass in a list or array of size N. In the below example
the <code class="docutils literal notranslate"><span class="pre">rotation_angle_xaxis</span></code> and <code class="docutils literal notranslate"><span class="pre">rotation_angle_yaxis</span></code> will be unique for every node</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
   <span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
   <span class="n">rotation_angle_xaxis</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">360.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
   <span class="n">rotation_angle_yaxis</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">360.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
   <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;biophysical&#39;</span><span class="p">,</span>
   <span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
<p>If a parameter requires compounded data you can use a tuple or a list of tuples. For example, we may want to represent a
cell’s position by a range:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">pos_with_jitter</span><span class="o">=</span><span class="p">[(</span><span class="n">p</span><span class="o">-</span><span class="n">rand</span><span class="p">(),</span> <span class="n">p</span><span class="o">+</span><span class="n">rand</span><span class="p">())</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">],</span>
        <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<section id="node-representation">
<h3>Node Representation<a class="headerlink" href="#node-representation" title="Permalink to this headline">¶</a></h3>
<p>When <code class="xref py py-meth docutils literal notranslate"><span class="pre">NetworkBuilder.build()</span></code> is called, each node will be given a unique
<strong>node_id</strong> value, and each type model (eg each call to add_nodes) will also be given a <strong>node_type_id</strong>. It is possible
to set the <strong>node_id</strong> and <strong>node_type_id</strong> parameter yourself but it’s generally not a good idea.</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">NetworkBuilder.nodes()</span></code> will return an iterator of the nodes in a
network. By default, it returns all nodes but one can filter by specific property values. The nodes themselves can have
their properties accessed like a dictionary. For example to get all biophysically detailed inh neurons:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;biophysical&#39;</span><span class="p">,</span> <span class="n">ei</span><span class="o">=</span><span class="s1">&#39;inh&#39;</span><span class="p">):</span>
   <span class="n">x</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">&#39;position_x&#39;</span><span class="p">]</span>
   <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="useful-node-parameters">
<h3>Useful Node Parameters<a class="headerlink" href="#useful-node-parameters" title="Permalink to this headline">¶</a></h3>
<p>As mentioned above the modeler can use any parameters and values they require to represent their models. The following
are parameters that will be recognized and used by the BMTK simulator (but not necessarily required). For a complete
list see <a class="reference external" href="https://github.com/AllenInstitute/sonata/blob/master/docs/SONATA_DEVELOPER_GUIDE.md#nodes---required-attributes">SONATA</a>:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x (or y, z)</p></td>
<td><p>x positions of soma in world coordinates</p></td>
</tr>
<tr class="row-odd"><td><p>rotation_angle_xaxis (or y, z)</p></td>
<td><p>rotation of the morphology around the soma</p></td>
</tr>
<tr class="row-even"><td><p>model_type</p></td>
<td><p>level of representation of neurons (biophysical, point_neuron, virtual)</p></td>
</tr>
<tr class="row-odd"><td><p>model_template</p></td>
<td><p>String name of the template to create (eg, ctdb:Biophys1.hoc, nest:glif_lif, etc)</p></td>
</tr>
<tr class="row-even"><td><p>model_processing</p></td>
<td><p>Directive or function that will be applied to neuron model after creation. For Allen Cell Types models use aibs_perisomatic or aibs_allactive</p></td>
</tr>
<tr class="row-odd"><td><p>dynamics_params</p></td>
<td><p>Channel and mechanism parameters for neuron, usually a name of a json or NeuronML file. Will overwrite model_template.</p></td>
</tr>
<tr class="row-even"><td><p>morphology</p></td>
<td><p>Name of the detailed morphology file (usually SWC).</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="building-edges">
<h2>Building Edges<a class="headerlink" href="#building-edges" title="Permalink to this headline">¶</a></h2>
<p>To define different types of edges between two subsets of nodes you should use the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">NetworkBuilder.add_edges()</span></code> method. Then once
<code class="xref py py-meth docutils literal notranslate"><span class="pre">NetworkBuilder.build()</span></code> method is called the the actual connections will
be instantiated based on the <strong>connectivity_rule</strong> property the user defines. A typical call to add_edges would be the following</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span>
      <span class="n">source</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ei&#39;</span><span class="p">:</span> <span class="s1">&#39;inh&#39;</span><span class="p">},</span>                                 <span class="c1"># 1</span>
      <span class="n">target</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ei&#39;</span><span class="p">:</span> <span class="s1">&#39;exc&#39;</span><span class="p">,</span> <span class="s1">&#39;ephys_type&#39;</span><span class="p">:</span> <span class="s1">&#39;fast_spiking&#39;</span><span class="p">},</span>
      <span class="n">connection_rule</span><span class="o">=</span><span class="n">my_connection_func</span><span class="p">,</span>                   <span class="c1"># 2</span>
      <span class="n">dynamic_parameters</span><span class="o">=</span><span class="s1">&#39;i2e.json&#39;</span><span class="p">,</span>                        <span class="c1"># 3</span>
      <span class="n">synaptic_model</span><span class="o">=</span><span class="s1">&#39;alphaSyn&#39;</span><span class="p">,</span>
      <span class="n">syn_weight</span><span class="o">=</span><span class="mf">1.34e-05</span><span class="p">,</span>
      <span class="n">delay</span><span class="o">=</span><span class="mf">2.0</span>
<span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>parameters <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">target</span></code> are used to filter out the subset of nodes used pre-and post-synapse, respectively.
In this case, the source population consists of all inhibitory (ei=inh) neurons, while the target population consists
only of excitatory (ei=exc) fast-spiking neurons. If the source or target is not specified then all possible nodes will
be used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">connection_rule</span></code> is used to determine the number of connections between each source and the target node. If the value
is given as an integer N then all possible source/target pairs with have N different connections. You can also pass
in a list-of-list or a matrix. But usually, a user-defined function is used, which will be better described in the
next section.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dynamic_parameters</span></code>, <code class="docutils literal notranslate"><span class="pre">synaptic_model</span></code>, <code class="docutils literal notranslate"><span class="pre">syn_weight</span></code>, and <code class="docutils literal notranslate"><span class="pre">delay</span></code> are all shared connection parameters. Like
with nodes, modelers can choose whatever parameters they deem best to represent their network. A list of useful
parameters pre-defined by BMTK and SONATA is described below.</p></li>
</ol>
<p>Also, like the nodes, it is possible to have unique values for every individual edge, but it is a little more difficult.
See the section on ConnectionMap for more info.</p>
<section id="connection-rules">
<h3>Connection rules<a class="headerlink" href="#connection-rules" title="Permalink to this headline">¶</a></h3>
<p>The connection_rule parameter of add_edges() method will usually be a user-defined function (but may also be an integer,
list-of-lists, or matrix). The function’s first two parameters will be source and target, Node objects whose properties
can be accessed like a dictionary. It should return an integer N for the number of connections between the source and
target, 0 or None if there is no connection.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_connection_func</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
   <span class="n">src_pos</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span>
   <span class="n">trg_pos</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span>
   <span class="o">...</span>
   <span class="k">return</span> <span class="n">N_syns</span>

<span class="n">net</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span>
   <span class="n">source</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ei&#39;</span><span class="p">:</span> <span class="s1">&#39;inh&#39;</span><span class="p">},</span> <span class="n">target</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ei&#39;</span><span class="p">:</span> <span class="s1">&#39;exc&#39;</span><span class="p">,</span> <span class="s1">&#39;ephys_type&#39;</span><span class="p">:</span> <span class="s1">&#39;fast_spiking&#39;</span><span class="p">},</span>
   <span class="n">connection_rule</span><span class="o">=</span><span class="n">my_connection_func</span><span class="p">,</span>
   <span class="n">dynamic_parameters</span><span class="o">=</span><span class="s1">&#39;i2e.json&#39;</span><span class="p">,</span>
   <span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
<p>If the connection_rule function requires additional arguments, use the connection_params option:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_connection_func</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">min_edges</span><span class="p">,</span> <span class="n">max_edges</span><span class="p">):</span>
   <span class="n">src_pos</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span>
   <span class="n">trg_pos</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span>
   <span class="o">...</span>
   <span class="k">return</span> <span class="n">N_syns</span>

<span class="n">net</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span>
   <span class="n">source</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ei&#39;</span><span class="p">:</span> <span class="s1">&#39;inh&#39;</span><span class="p">},</span> <span class="n">target</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ei&#39;</span><span class="p">:</span> <span class="s1">&#39;exc&#39;</span><span class="p">,</span> <span class="s1">&#39;ephys_type&#39;</span><span class="p">:</span> <span class="s1">&#39;fast_spiking&#39;</span><span class="p">},</span>
   <span class="n">connection_rule</span><span class="o">=</span><span class="n">my_connection_func</span><span class="p">,</span>
   <span class="n">connection_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;min_edges&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max_edges&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span>
   <span class="n">dynamic_parameters</span><span class="o">=</span><span class="s1">&#39;i2e.json&#39;</span><span class="p">,</span>
   <span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
<p>When <code class="xref py py-meth docutils literal notranslate"><span class="pre">NetworkBuilder.build()</span></code> is executed my_connection_func() will be
automatically called for all possible source/target pair of nodes and the connectivity matrix will be called.</p>
<p>Sometimes it may be more efficient or necessary to set all incoming (or outgoing) connections in one function. For
example, we may need to limit the total number of synapses on a target. The <code class="docutils literal notranslate"><span class="pre">iterator</span></code> parameter allows the modeler to
change the signature and return values of their connection_rule function. By setting <code class="docutils literal notranslate"><span class="pre">iterator</span></code> to <strong>all_to_one</strong>,
instead of passing in a single source neuron it will pass in a list of all N source neurons, and will expect a
corresponding list of size N</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bulk_connection_func</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
   <span class="n">trg_pos</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span>
   <span class="n">syn_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">))</span>
   <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
      <span class="n">src_pos</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span>
      <span class="o">...</span>
   <span class="k">return</span> <span class="n">syn_list</span>
</pre></div>
</div>
<p>There is also an <strong>all_to_one</strong> iterator option that will pair each source node with a list of all available target nodes.</p>
</section>
<section id="individual-edge-properties-the-connectionmap">
<h3>Individual Edge Properties (The ConnectionMap)<a class="headerlink" href="#individual-edge-properties-the-connectionmap" title="Permalink to this headline">¶</a></h3>
<p>Sometimes it is necessary for each edge to have unique property values. For example, the individual syn_weight value for
each synapse may vary depending on the location and type of the pre-and post-synaptic nodes. With nodes,
you can pass in a list or array of size N for each N node. But when edges are built using a connection_rule function
the exact number of connections will not be known in advance.</p>
<p>each call to add_edges returns a <a class="reference internal" href="bmtk/bmtk.builder.html#bmtk.builder.connection_map.ConnectionMap" title="bmtk.builder.connection_map.ConnectionMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionMap</span></code></a> object. The
<a class="reference internal" href="bmtk/bmtk.builder.html#bmtk.builder.connection_map.ConnectionMap.add_properties" title="bmtk.builder.connection_map.ConnectionMap.add_properties"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionMap.add_properties()</span></code></a> method allows us to
add individual properties for each edge using our own user defined functions. Like with our connection_rule function,
the connection_map <code class="docutils literal notranslate"><span class="pre">rule</span></code> function takes in a source and target node and returns a corresponding value:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_syn_weight_by_dist</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
   <span class="n">src_pos</span><span class="p">,</span> <span class="n">trg_pos</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">],</span> <span class="n">target</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span>
   <span class="o">...</span>
   <span class="k">return</span> <span class="n">syn_weight</span>

<span class="n">cm</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="o">....</span><span class="p">)</span>
<span class="n">cm</span><span class="o">.</span><span class="n">add_properties</span><span class="p">(</span><span class="s1">&#39;syn_weight&#39;</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="n">set_syn_weight_by_dist</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="n">cm</span><span class="o">.</span><span class="n">add_properties</span><span class="p">(</span><span class="s1">&#39;delay&#39;</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="o">*</span><span class="n">_</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">),</span> <span class="n">dtypes</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">rule</span></code> requires extra arguments we can use the <code class="docutils literal notranslate"><span class="pre">rule_params</span></code> option:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_syn_weight_by_dist</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">min_weight</span><span class="p">,</span> <span class="n">max_weight</span><span class="p">):</span>
   <span class="n">src_pos</span><span class="p">,</span> <span class="n">trg_pos</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">],</span> <span class="n">target</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span>
   <span class="o">...</span>
   <span class="k">return</span> <span class="n">syn_weight</span>

<span class="n">cm</span><span class="o">.</span><span class="n">add_properties</span><span class="p">(</span>
   <span class="n">name</span><span class="o">=</span><span class="s1">&#39;syn_weight&#39;</span><span class="p">,</span>
   <span class="n">rule</span><span class="o">=</span><span class="n">set_syn_weight_by_dist</span><span class="p">,</span>
   <span class="n">rule_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;min_weight&#39;</span><span class="p">:</span> <span class="mf">1.0e-06</span><span class="p">,</span> <span class="s1">&#39;max_weight&#39;</span><span class="p">:</span> <span class="mf">1.0e-04</span><span class="p">},</span>
   <span class="n">dtypes</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span>
<span class="p">)</span>
</pre></div>
</div>
<p>It is also possible to set multiple parameters in a single function. For example, for each synapse, we may want to set
the distance between the soma, and the neuronal area (soma, apical dendrites, basal dendrites, etc). To do so our <code class="docutils literal notranslate"><span class="pre">name</span></code>
and <code class="docutils literal notranslate"><span class="pre">dtypes</span></code> parameters take a list, and our rule function now returns two values</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_target_location</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
   <span class="o">...</span>
   <span class="k">return</span> <span class="n">syn_region</span><span class="p">,</span> <span class="n">syn_dist</span>

<span class="n">cm</span><span class="o">.</span><span class="n">add_properties</span><span class="p">(</span>
   <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;syn_region&#39;</span><span class="p">,</span> <span class="s1">&#39;syn_dist&#39;</span><span class="p">],</span>
   <span class="n">rule</span><span class="o">=</span><span class="n">set_syn_weight_by_dist</span><span class="p">,</span>
   <span class="n">dtypes</span><span class="o">=</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="intra-network-connections">
<h3>Intra-Network Connections<a class="headerlink" href="#intra-network-connections" title="Permalink to this headline">¶</a></h3>
<p>Both BMTK and SONATA support a network to be built piecemeal and combined into one at simulation time. A cortical
the region will receive inputs from many other regions, and a modeler may want to test the dynamics when different
combinations of inputs are turned on and off. Instead of building multiple models of the region with different inputs,
instead, we can build the nodes, recurrent and inter-network connections each region independently and turn them on and
off during the simulation (see <a class="reference external" href="./simulators.html#configuration-files">simulation config</a>)</p>
<p>Creating connections between two different networks is very similar to creating recurrent connections and still use the
add_edges method. The main difference is for our <code class="docutils literal notranslate"><span class="pre">source</span></code> or <code class="docutils literal notranslate"><span class="pre">target</span></code> argument, instead of using a dictionary we must
use the <code class="xref py py-meth docutils literal notranslate"><span class="pre">NetworkBuilder.nodes()</span></code> method of another network. For example, we
have two networks called <strong>LGN</strong> and <strong>V1</strong> and we want to create a connection type from LGN’s excitatory neurons (ei=exc)
V1’s pyramidal cells</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">v1</span> <span class="o">=</span> <span class="n">NetworkBuilder</span><span class="p">(</span><span class="s1">&#39;V1&#39;</span><span class="p">)</span>
<span class="o">...</span> <span class="c1"># Build V1 network</span>

<span class="n">lgn</span> <span class="o">=</span> <span class="n">NetworkBuilder</span><span class="p">(</span><span class="s1">&#39;LGN&#39;</span><span class="p">)</span>
<span class="n">lgn</span><span class="o">.</span><span class="n">add_nodes</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;virtual&#39;</span><span class="p">,</span> <span class="n">ei</span><span class="o">=</span><span class="s1">&#39;exc&#39;</span><span class="p">)</span>
<span class="n">lgn</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span>
   <span class="n">source</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ei&#39;</span><span class="p">:</span> <span class="s1">&#39;exc&#39;</span><span class="p">},</span>                  <span class="c1"># dict indicates source population coming from lgn_net</span>
   <span class="n">target</span><span class="o">=</span><span class="n">v1</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="s1">&#39;model_type&#39;</span><span class="p">:</span> <span class="s1">&#39;pyr&#39;</span><span class="p">),</span>  <span class="c1"># target population coming form V1 network</span>
   <span class="n">connection_rule</span><span class="o">=</span><span class="n">input_conn_fnc</span><span class="p">,</span>
   <span class="o">...</span>
<span class="p">)</span>
<span class="n">lgn</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
</pre></div>
</div>
<p>When creating intra-network connections the <code class="xref py py-meth docutils literal notranslate"><span class="pre">NetworkBuilder.import()</span></code>
method can be very useful.</p>
</section>
<section id="edge-accessor-methods">
<h3>Edge Accessor methods<a class="headerlink" href="#edge-accessor-methods" title="Permalink to this headline">¶</a></h3>
<section id="networkbuilder-edges">
<h4><code class="xref py py-meth docutils literal notranslate"><span class="pre">NetworkBuilder.edges()</span></code><a class="headerlink" href="#networkbuilder-edges" title="Permalink to this headline">¶</a></h4>
<p>The method will return an iterator of edges filtered by edge and/or node properties. Each edge will be
represented using a <a class="reference internal" href="bmtk/bmtk.builder.html#bmtk.builder.edge.Edge" title="bmtk.builder.edge.Edge"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edge</span></code></a> object</p>
</section>
</section>
<section id="useful-edge-parameters">
<h3>Useful Edge Parameters<a class="headerlink" href="#useful-edge-parameters" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>syn_weight</p></td>
<td><p>synaptic weight</p></td>
</tr>
<tr class="row-odd"><td><p>delay</p></td>
<td><p>synaptic delay, in ms</p></td>
</tr>
<tr class="row-even"><td><p>model_template</p></td>
<td><p>String name of the template to create an object from parameters in dynamics_params</p></td>
</tr>
<tr class="row-odd"><td><p>dynamics_params</p></td>
<td><p>dynamic parameter overrides for edges</p></td>
</tr>
<tr class="row-even"><td><p>efferent_section_id</p></td>
<td><p>location of (NEURON) section where the connection will target</p></td>
</tr>
<tr class="row-odd"><td><p>efferent_section_pos</p></td>
<td><p>distance within the (NEURON) section where synapse will target</p></td>
</tr>
<tr class="row-even"><td><p>target_sections</p></td>
<td><p>A list of neuronal sections where the synapse will target (soma, axon, apical, basal). When used in place of section_id, BioNet will randomly select a section on the target neuron</p></td>
</tr>
<tr class="row-odd"><td><p>distance_range</p></td>
<td><p>A range in um of the distance from the soma, used along with target_sections param to randomly target certain areas of the post-synaptic neuron.</p></td>
</tr>
<tr class="row-even"><td><p>weight_function</p></td>
<td><p>Name of the detailed morphology file (usually SWC).</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="saving-and-building">
<h2>Saving and Building<a class="headerlink" href="#saving-and-building" title="Permalink to this headline">¶</a></h2>
<p>Once all calls to add_nodes and ad_edges have been made, use the build() method to actually complete and fully
instantiate the network. Certain accessor functions, like
<code class="xref py py-meth docutils literal notranslate"><span class="pre">NetworkBuilder.nodes()</span></code> and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">NetworkBuilder.edges()</span></code> will not work until all the edges have been
completed. Depending on the size of the network and the complexity of the connectivity rules, it can take anywhere from
less than a second to days to build the full model.</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">NetworkBuilder.save(output_dir=’/path/to/output/net/’)</span></code> method will
write the network to a disk in SONATA format at the given output_dir path. By default nodes and edges will be written to
different files using the network names to determine the sonata file names. The
<code class="xref py py-meth docutils literal notranslate"><span class="pre">NetworkBuilder.save_nodes()</span></code> and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">NetworkBuilder.save_edges()</span></code> functions may also used to only write
out the nodes or the edges, respectively.</p>
</section>
<section id="network-format">
<h2>Network Format<a class="headerlink" href="#network-format" title="Permalink to this headline">¶</a></h2>
<p>This is a brief overview of how NetworkBuilder saves the network’s nodes and edges files. As mentioned BMTK uses the
SONATA format, so more in-depth descriptions may be
<a class="reference external" href="https://github.com/AllenInstitute/sonata/blob/master/docs/SONATA_DEVELOPER_GUIDE.md#representing-networks-of-neurons">found here</a>.
Opening the HDF5 file will require a hdf browser like HDFView, or a library like h5py. You can also use
<a class="reference external" href="https://github.com/AllenInstitute/sonata/tree/master/src/pysonata">pySONATA</a> or
<a class="reference external" href="https://github.com/BlueBrain/libsonata">libSONATA</a> which are API’s for reading in SONATA files</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/sonata_structure.jpg"><img alt="_images/sonata_structure.jpg" src="_images/sonata_structure.jpg" style="width: 732.6px; height: 363.6px;" /></a>
</figure>
</section>
<section id="advanced-features">
<h2>Advanced Features<a class="headerlink" href="#advanced-features" title="Permalink to this headline">¶</a></h2>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Building Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulators.html">Simulation Engines</a><ul>
<li class="toctree-l2"><a class="reference internal" href="bionet.html">BioNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="pointnet.html">PointNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="popnet.html">PopNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="filternet.html">FilterNet</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="analyzer.html">Analyzing the Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Main Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial_NetworkBuilder_Intro.html">Builder: Using the Network Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_single_cell_clamped.html">BioNet: Single cell with current injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_single_cell_syn.html">BioNet: Single with with synaptic input</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_single_pop.html">BioNet: Multiple Nodes with single cell-type</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_multi_pop.html">BioNet: Heterogeneous network</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_pointnet_modeling.html">PointNet: Point-neuron modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_population_modeling.html">PopNet: Population-based firing rate models</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_filter_models.html">FilterNet: Full-field flashing movie</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ad_tutorials.html">Additional Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial_cell_placement.html">Cell placement: Using BMTK functions for distributing units</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_dynamic_synapses.html">Accessing synapse models in NEST to model dynamic synapses</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_spike_trains_refractory.html">Creating spike trains with refractory periods</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Example Networks</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/AllenInstitute/bmtk.git">Github Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="workshop.html">Annual Modeling Software Workshop</a></li>
<li class="toctree-l1"><a class="reference internal" href="registration.html">Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to_cite.html">How to Cite</a></li>
<li class="toctree-l1"><a class="reference internal" href="bmtk/bmtk.html">Source Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="bmtk/bmtk.analyzer.html">bmtk.analyzer package</a></li>
<li class="toctree-l2"><a class="reference internal" href="bmtk/bmtk.builder.html">bmtk.builder package</a></li>
<li class="toctree-l2"><a class="reference internal" href="bmtk/bmtk.simulator.html">bmtk.simulator package</a></li>
<li class="toctree-l2"><a class="reference internal" href="bmtk/bmtk.tests.html">bmtk.tests package</a></li>
<li class="toctree-l2"><a class="reference internal" href="bmtk/bmtk.utils.html">bmtk.utils package</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>


    <div class="footer" role="contentinfo">
    </div>
<script type="text/javascript" src="_static/external_assets/javascript/portalFooter.js"></script>

  </body>
</html>